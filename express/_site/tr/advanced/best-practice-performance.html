<!DOCTYPE html>
<!---
 Copyright (c) 2016 StrongLoop, IBM, and Express Contributors
 License: MIT
-->

<html lang="tr" prefix="og: http://ogp.me/ns#">

  <head>
    <title>Ãœretim (Production) ortamÄ±nda Express kullanarak en iyi performans pratikleri</title>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="og:image" content="https://expressjs.com/images/express-facebook-share.png">
    <link rel="icon" type="image/png" href="/images/favicon.png" />
    <link rel="stylesheet" href="/css/style.css?_=1652552968">
    <link rel="stylesheet" href="/css/dropit.css">
    <link rel="stylesheet" href="/css/prism.css">
    <link rel="stylesheet" href="/css/font-awesome.min.css">
    <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Open+Sans:300,400,600,700&amp;amp;subset=latin,latin-ext">
    <link rel="stylesheet" href="/css/tr.css">
    <link rel="stylesheet" href="/css/nodeinteractive.css">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <script data-cfasync="false" src="//ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
    <script data-cfasync="false" src="/js/ismobile.js"></script>
    <script data-cfasync="false" src="/js/app.js"></script>
    <script data-cfasync="false" src="/js/retina.js"></script>
    <script data-cfasync="false" src="/js/dropit.js"></script>
    <script data-cfasync="false" src="/js/prism.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css" />

</head>


  
  <body class="non-en-doc">
  

    <section class="page content">

      <header>
  <div style="text-align: center; background: #010101; color: #f1f1f1; padding: 16px; font-size: 16px; width: 100vw">
    Black Lives Matter. <a style="color: #5E80F7; text-decoration: none;" href="https://support.eji.org/give/153413/#!/donation/checkout">Support the Equal Justice Initiative</a>.
  </div>
  <div id="mobile-menu">
      <div id="nav-button" class="fa fa-bars fa-2x button"></div>
  </div>
  <section id="logo"><a href="/" class="express">Express</a>
  </section>
  <div id="navbar">
      <input id="q" placeholder="ğŸ” search" />
      <ul id="navmenu">
          <li><a href="/" id="home-menu">Anasayfa</a></li>
          <li>
              <ul id="getting-started-menu" class="menu">
                  <li><a href="/tr/starter/installing.html">Buradan BaÅŸlayÄ±n</a>
                      <ul>
                          <li>
                            <a href="/tr/starter/installing.html">
                              Kurulum
                            </a>
                          </li>
                          <li>
                            <a href="/tr/starter/hello-world.html">
                              Merhaba DÃ¼nya
                            </a>
                          </li>
                          <li>
                          <a href="/tr/starter/generator.html">
                            Express OluÅŸturucu
                          </a>
                          </li>
                          <li>
                            <a href="/tr/starter/basic-routing.html">
                              Basit YÃ¶nlendirme
                            </a>
                          </li>
                          <li>
                            <a href="/tr/starter/static-files.html">
                              Statik Dosyalar
                            </a>
                          </li>
                          <li>
                            <a href="/tr/starter/faq.html">
                              SSS
                            </a>
                          </li>
                      </ul>
                  </li>
              </ul>
          </li>
          <li>
              <ul id="guide-menu" class="menu">
                  <li><a href="/tr/guide/routing.html">KÄ±lavuz</a>
                      <ul>
                          <li><a href="/tr/guide/routing.html">YÃ¶nlendirme</a>
                          </li>
                          <li><a href="/tr/guide/writing-middleware.html">
						  Middleware yazma</a>
                          </li>
                          <li><a href="/tr/guide/using-middleware.html">Middleware kullanma</a>
                          </li>
                          <li><a href="/tr/guide/using-template-engines.html">Åablon motoru kullanma</a>
                          </li>
                          <li><a href="/tr/guide/error-handling.html">Hata iÅŸleme</a>
                          </li>
                          <li><a href="/tr/guide/debugging.html">Hata AyÄ±klama</a>
                          </li>
                          <li><a href="/tr/guide/behind-proxies.html">Express behind proxies</a>
                          </li>
                          <li><a href="/tr/guide/migrating-4.html">Express 4 geÃ§iÅŸ</a>
                          </li>
                          <li><a href="/tr/guide/migrating-5.html">Express 5 geÃ§iÅŸ</a>
                          </li>
                          <li><a href="/tr/guide/database-integration.html">Database Entegrasyonu</a>
                          </li>
                      </ul>
                  </li>
              </ul>
          </li>
          <li>
              <ul id="application-menu" class="menu">
                  <li><a href="/tr/4x/api.html">API Kaynak</a>
                      <ul>
                          <li><a href="/tr/4x/api.html">4.x</a>
                          </li>
                          <li><a href="/tr/3x/api.html">3.x (KullanÄ±mdan kaldÄ±rÄ±ldÄ±)</a>
                          </li>
                          <li><a href="/2x/">2.x (KullanÄ±mdan kaldÄ±rÄ±ldÄ±)</a>
                          </li>
                      </ul>
                  </li>
              </ul>
          </li>
          <li>
              <ul id="advanced-topics-menu" class="menu">
                  <li><a href="/tr/advanced/developing-template-engines.html" class="active">GeliÅŸmiÅŸ konular</a>
                      <ul>
                          <li><a href="/tr/advanced/developing-template-engines.html">Åablon motorlarÄ±</a>
                          </li>
                          <li><a href="/tr/advanced/pm.html">Proses yÃ¶neticisi kullanma</a>
                          </li>
                          <li><a href="/tr/advanced/security-updates.html">GÄŸvenlik gÃ¼ncellemeleri</a>
                          </li>
                          <li><a href="/tr/advanced/best-practice-security.html">En iyi gÃ¼venlik uygulamalarÄ±</a>
                          </li>
                          <li><a href="/tr/advanced/best-practice-performance.html">En iyi performans uygulamalarÄ±</a>
                          </li>
                      </ul>
                  </li>
              </ul>
          </li>
          <li>
              <ul id="resources-menu" class="menu">
                  <li><a href="/tr/resources/glossary.html">Kaynaklar</a>
                      <ul>
                          <li>
                            <a href="/tr/resources/community.html">Topluluk</a>
                          </li>
                          <li>
                            <a href="/tr/resources/glossary.html">Terimler</a>
                          </li>
                          <li>
                            <a href="/tr/resources/middleware.html">Middleware</a>
                          </li>
                          <li>
                            <a href="/tr/resources/utils.html">YardÄ±mcÄ± ModÃ¼ller</a>
                          </li>
                          <li>
                            <a href="/tr/resources/frameworks.html">YapÄ±lar</a>
                          </li>
                          <li>
                            <a href="/tr/resources/learning.html">Ek Ã¶ÄŸrenme</a>
                          </li>
                          <li>
                            <a href="/tr/resources/companies-using-express.html">Express kullanan ÅŸirket</a>
                          </li>
                          <li>
                            <a href="/tr/resources/contributing.html">Express'e katkÄ±da bulunmak</a>
                          </li>
                          <li>
                            <a href="/tr/changelog/4x.html">SÃ¼rÃ¼m NotlarÄ±</a>
                          </li>
                      </ul>
                  </li>
              </ul>
          </li>
          <!--
          <li>
              <ul id="changelog-menu" class="menu">
                  <li><a href="/tr/changelog/4x.html">Changelog</a>
                      <ul>
                          <li><a href="/tr/changelog/4x.html">4.x</a></li>
                      </ul>
                  </li>
              </ul>
          </li>
        -->
      </ul>
  </div>
</header>


      <div id="overlay"></div>

      
        <div id="i18n-notice-box" class="doc-box doc-warn">
          <p>Bu dokÃ¼man ingilizce dokÃ¼mana gÃ¶re eski olabilir. Son gÃ¼ncellemeler iÃ§in lÃ¼tfen <a href="/">Ä°ngilizce DokÃ¼manÄ±</a>. ziyaret edin
</p>
<div id="close-i18n-notice-box" title="Close">âœ–</div>

        </div>
      
      <div id="page-doc" markdown="1">
<h1 id="retim-ortam-en-iyi-pratikleri-performans-ve-gvenilirlik">Ãœretim ortamÄ± en iyi pratikleri: performans ve gÃ¼venilirlik</h1>

<h2 id="genel-bak">Genel bakÄ±ÅŸ</h2>

<p>Bu makalede Ã¼retim ortamÄ±na daÄŸÄ±tÄ±lÄ±mÄ±ÅŸ Express uygulamalarÄ± iÃ§in en iyi performans ve gÃ¼venilirlik pratikleri anlatÄ±lÄ±yor.</p>

<p>Bu konu aÃ§Ä±kÃ§a her iki geleneksel geliÅŸtirme ve operasyonlarÄ± da kapsayarak â€œdevopsâ€ dÃ¼nyasÄ±na girer. Buna gÃ¶re, buradaki bilgiler iki kÄ±sma ayrÄ±lmÄ±ÅŸtÄ±r:</p>

<ul>
  <li>Kodunuzda yapÄ±lacak ÅŸeyler (geliÅŸtirme kÄ±smÄ±):
    <ul>
      <li><a href="#use-gzip-compression">gzip sÄ±kÄ±ÅŸtÄ±rma kullan</a></li>
      <li><a href="#dont-use-synchronous-functions">Senkron fonksiyonlar kullan</a></li>
      <li><a href="#do-logging-correctly">LoglamayÄ± doÄŸru yap</a></li>
      <li><a href="#handle-exceptions-properly">Ä°stisnalarÄ± dÃ¼zgÃ¼n iÅŸle</a></li>
    </ul>
  </li>
  <li>OrtamÄ±nÄ±zda / kurulumunuzda yapÄ±lacak ÅŸeyler (operasyon kÄ±smÄ±):
    <ul>
      <li><a href="#set-node_env-to-production">NODE_ENV deÄŸerini â€œproductionâ€ olarak ayarla</a></li>
      <li><a href="#ensure-your-app-automatically-restarts">UygulamanÄ±zÄ±n otomatik olarak yeniden baÅŸlatÄ±ldÄ±ÄŸÄ±ndan emin ol</a></li>
      <li><a href="#run-your-app-in-a-cluster">UygulamanÄ±zÄ± bir kÃ¼mede (cluster) koÅŸ</a></li>
      <li><a href="#cache-request-results">Ä°stek sonuÃ§larÄ±nÄ± Ã¶nbelleÄŸe al (cache)</a></li>
      <li><a href="#use-a-load-balancer">Bir yÃ¼k dengeleyicisi (load balancer) kullan</a></li>
      <li><a href="#use-a-reverse-proxy">Bir ters proxy kullan (reverse proxy)</a></li>
    </ul>
  </li>
</ul>

<h2 id="in-code">Kodunuzda yapÄ±lacak ÅŸeyler</h2>

<p>UygulamanÄ±zÄ±n performansÄ±nÄ± iyileÅŸtirmek iÃ§in yapabileceÄŸiniz bazÄ± ÅŸeyler:</p>

<ul>
  <li><a href="#use-gzip-compression">gzip sÄ±kÄ±ÅŸtÄ±rma kullan</a></li>
  <li><a href="#dont-use-synchronous-functions">Senkron fonksiyonlar kullanma</a></li>
  <li><a href="#do-logging-correctly">LoglamayÄ± doÄŸru yap</a></li>
  <li><a href="#handle-exceptions-properly">Ä°stisnalarÄ± dÃ¼zgÃ¼n iÅŸle</a></li>
</ul>

<h3 id="gzip-sktrma-kullan">gzip sÄ±kÄ±ÅŸtÄ±rma kullan</h3>

<p>Gzip sÄ±kÄ±ÅŸtÄ±rma, yanÄ±t gÃ¶vdesininin boyutunu bÃ¼yÃ¼k Ã¶lÃ§Ã¼de azaltabilir ve dolayÄ±sÄ±yla da web uygulamanÄ±n hÄ±zÄ±nÄ± arttÄ±rÄ±r. Express uygulamanÄ±zda gzip sÄ±kÄ±ÅŸtÄ±rmasÄ± iÃ§in <a href="https://www.npmjs.com/package/compression">compression</a> ara yazÄ±lÄ±mÄ±nÄ± kullanÄ±n. Ã–rnek olarak:</p>

<pre><code class="language-js">const compression = require('compression')
const express = require('express')
const app = express()
app.use(compression())
</code></pre>

<p>Ãœretim ortamÄ±ndaki yÃ¼ksek-trafikli bir website iÃ§in yapÄ±labilecek sÄ±kÄ±ÅŸtÄ±rmanÄ±n en iyi yolu ters proxy sevisyesinde uygulamaktÄ±r (bakÄ±nÄ±z <a href="#use-a-reverse-proxy">Ters proxy kullanÄ±mÄ±</a>). Bu durumda sÄ±kÄ±ÅŸtÄ±rma ara yazÄ±lÄ±mÄ± kullanmak zorunda deÄŸilsiniz. Nginxâ€™te gzip sÄ±kÄ±ÅŸtÄ±rmayÄ± devreye alma hakkÄ±nda daha fazla detay iÃ§in Nginx dÃ¶kÃ¼mantasyonuna bakÄ±nÄ±z <a href="http://nginx.org/en/docs/http/ngx_http_gzip_module.html">ngx_http_gzip_module modÃ¼lÃ¼</a>.</p>

<h3 id="senkron-fonksiyonlar-kullanma">Senkron fonksiyonlar kullanma</h3>

<p>Senkron fonksiyon ve metodlar kod Ã§alÄ±ÅŸtÄ±rma sÃ¼recini bir ÅŸey dÃ¶ndÃ¼rene kadar tutarlar. Senkron bir fonksiyona yapÄ±lacak bir Ã§aÄŸrÄ± birkaÃ§ mikrosaniye veya milisaniye iÃ§inde dÃ¶nerler, ancak yÃ¼ksek-trafikli websitelerde bu Ã§aÄŸrÄ±lar toplanÄ±p uygulamanÄ±n performansÄ±nÄ± dÃ¼ÅŸÃ¼rÃ¼rler. Ãœretim ortamÄ±nda bu kullanÄ±mdan uzak durun.</p>

<p>Node ve birÃ§ok modÃ¼l kendi fonksiyonlarÄ±nÄ±n senkron ve asenkron versiyonlarÄ±nÄ± sunmalarÄ±na raÄŸmen, Ã¼retim ortamÄ±nda her zaman asenkron versiyonlarÄ± kullanÄ±n. Senkron bir fonksiyonun kullanÄ±mÄ±nÄ±n haklÄ± olabileceÄŸi tek zaman uygulamanÄ±n ilk baÅŸlangÄ±cÄ±dÄ±r.</p>

<p>Node.js 4.0+ veya io.js 2.1.0+ kullanÄ±yorsanÄ±z, uygulamanÄ±z senkron bir API kullandÄ±ÄŸÄ±nda bir uyarÄ± ve yÄ±ÄŸÄ±n izleme (stack trace) yazdÄ±rmak iÃ§in <code>--trace-sync-io</code> komut satÄ±rÄ± bayraÄŸÄ±nÄ± kullanabilirsiniz. Elbette bunu Ã¼retim ortamÄ±nda kullanmak istemezsiniz, daha Ã§ok bunu kodunuzun Ã¼retim iÃ§in hazÄ±r olduÄŸundan emin olmak iÃ§in. Daha fazla bilgi iÃ§in bakÄ±nÄ±z: <a href="https://nodejs.org/api/cli.html#cli_trace_sync_io">node komut satÄ±rÄ± seÃ§enekler dÃ¶kÃ¼mantasyonu</a>.</p>

<h3 id="loglamay-doru-yap">LoglamayÄ± doÄŸru yap</h3>

<p>Genelde, uygulamanÄ±zdan loglama yapmak iÃ§in iki neden vardÄ±r: Hata ayÄ±klama ve uygulama aktivitesini loglama iÃ§in (yani, diÄŸer her ÅŸey). GeliÅŸtirme ortamÄ±nda log mesajlarÄ±nÄ± terminale yazdÄ±rmak iÃ§in <code>console.log()</code> veya <code>console.error()</code> kullanmak yaygÄ±n bir kullanÄ±mdÄ±r. Ancak hedef bir terminal veya dosya olduÄŸunda <a href="https://nodejs.org/api/console.html#console_console_1">bu fonksiyonlar senkrondur</a>, dolayÄ±sÄ±yla, Ã§Ä±ktÄ±yÄ± baÅŸka bir programa aktarmadÄ±ÄŸÄ±nÄ±z sÃ¼rece bunlar Ã¼retim ortamÄ± iÃ§in uygun deÄŸiller.</p>

<h4 id="hata-ayklamak-iin">Hata ayÄ±klamak iÃ§in</h4>

<p>Hata ayÄ±klama amacÄ±yla loglama yapÄ±yorsanÄ±z, o zaman <code>console.log()</code> yerine <a href="https://www.npmjs.com/package/debug">debug</a> gibi Ã¶zel bir hata ayÄ±klama modÃ¼lÃ¼ kullanÄ±n. Bu modÃ¼l, <code>console.error()</code> fonksiyonuna gÃ¶nderilecek mesajlarÄ± kontrol etmek iÃ§in DEBUG ortam deÄŸiÅŸkenini kullanmanÄ±zÄ± saÄŸlar. UygulamanÄ±zÄ± sade asenkron halde tutmak istiyorsanÄ±z, yine <code>console.error()</code> Ã§Ä±ktÄ±larÄ±nÄ± baÅŸka bir programa aktarmanÄ±z gerekir. Ama yine de, Ã¼retim ortamÄ±nda hata ayÄ±klamayacaksÄ±nÄ±z, deÄŸil mi?</p>

<h4 id="uygulama-aktivitesi-iin">Uygulama aktivitesi iÃ§in</h4>

<p>Uygulama aktivitesini logluyorsanÄ±z (Ã¶rneÄŸin trafik izleme veya API Ã§aÄŸrÄ±larÄ±), <code>console.log()</code> yerine <a href="https://www.npmjs.com/package/winston">Winston</a> veya <a href="https://www.npmjs.com/package/bunyan">Bunyan</a> gibi bir loglama kÃ¼tÃ¼phanesi kullanÄ±n. Bu iki kÃ¼tÃ¼phanenin detaylÄ± bir karÅŸÄ±laÅŸtÄ±rmasÄ± iÃ§in, StrongLoop blog yazÄ±sÄ±na bakÄ±nÄ±z <a href="https://strongloop.com/strongblog/compare-node-js-logging-winston-bunyan/">Winston ve Bunyan Node.js Loglama KarÅŸÄ±laÅŸtÄ±rmasÄ±</a>.</p>

<h3 id="stisnalar-dzgn-ile">Ä°stisnalarÄ± dÃ¼zgÃ¼n iÅŸle</h3>

<p>Node uygulamalarÄ± yakalanmamÄ±ÅŸ istisnalar ile karÅŸÄ±laÅŸtÄ±klarÄ±nda patlarlar. Ä°stisnalarÄ± iÅŸlememe ve gerekli aksiyonlarÄ± almama Express uygulamanÄ±zÄ±n patlamasÄ±na ve Ã§evrimdÄ±ÅŸÄ±na Ã§Ä±kmasÄ±na neden olur. AÅŸaÄŸÄ±daki <a href="#ensure-your-app-automatically-restarts">UygulamanÄ±zÄ±n otomatik olarak yeniden baÅŸlatÄ±ldÄ±ÄŸÄ±ndan emin olma</a> tavsiyesine uyarsanÄ±z, o zaman uygulamanÄ±z bir Ã§Ã¶kmeden tekrar ayaÄŸa kalkabilir. Neyse ki Express uygulamalarÄ±nÄ±n tipik olarak kÄ±sa bir baÅŸlama sÃ¼resi var. Yine de patlamalardan kaÃ§Ä±nmak gerekir ve bunu yapmak iÃ§in de istisnalarÄ± uygun bir ÅŸekilde iÅŸlemeniz gerek.</p>

<p>TÃ¼m istisnalarÄ± iÅŸlediÄŸinizden emin olmak iÃ§in, aÅŸaÄŸÄ±daki teknikleri kullanÄ±n:</p>

<ul>
  <li><a href="#use-try-catch">try-catch</a></li>
  <li><a href="#use-promises">promises</a></li>
</ul>

<p>Bu konulara girmeden Ã¶nce Node/Express istisna iÅŸleme ile ilgili temel bir anlayÄ±ÅŸa sahip olmanÄ±z lazÄ±m: hata-Ã¶ncellikli geri Ã§aÄŸÄ±rmalarÄ± kullanmak ve hatalarÄ± ara yazÄ±lÄ±mda yaymak. Node, asenkron fonksiyonlardan hatalarÄ± dÃ¶nmek iÃ§in â€œhata-Ã¶ncellikli geri Ã§aÄŸÄ±rmaâ€ anlayÄ±ÅŸÄ±nÄ± kullanÄ±r, bu fonksiyonlarda birinci parametre hata objesi ve ondan sonraki parametreleri ise sonuÃ§ verileri takip eder. Hata olmadÄ±ÄŸÄ±nÄ± belirtmek iÃ§in ilk parametreye null geÃ§in. Ä°stisnalarÄ± anlamlÄ± bir ÅŸekilde iÅŸlemek iÃ§in bu geri Ã§aÄŸÄ±rma fonksiyonlarÄ±nÄ±n hata-Ã¶ncellikli geri Ã§aÄŸÄ±rma anlayÄ±ÅŸÄ±nÄ± takip etmesi gerek. Ve Expressâ€™te ara yazÄ±lÄ±m zincirinde hatalarÄ± yaymak iÃ§in en iyi yÃ¶ntem <code>next()</code> fonksiyonunu kullanmaktÄ±r.</p>

<p>Hata iÅŸleme temelleri hakkÄ±nda daha fazla bilgi iÃ§in bakÄ±nÄ±z:</p>

<ul>
  <li><a href="https://www.joyent.com/developers/node/design/errors">Node.jsâ€™te Hata Ä°ÅŸleme</a></li>
  <li><a href="https://strongloop.com/strongblog/robust-node-applications-error-handling/">GÃ¼Ã§lÃ¼ Node UygulamalarÄ± Yazmak: Hata Ä°ÅŸleme</a> (StrongLoop blogu)</li>
</ul>

<h4 id="ne-yapmamal">Ne yapmamalÄ±</h4>

<p><em>YapmamanÄ±z</em> gereken bir ÅŸey var, o da bir istisnanÄ±n olay dÃ¶ngÃ¼sÃ¼ne kadar Ã§Ä±karak yayÄ±lmasÄ±yla oluÅŸan <code>uncaughtException</code> olayÄ±nÄ± dinlememek. <code>uncaughtException</code> iÃ§in bir olay dinleyici eklemek, istisna ile karÅŸÄ±laÅŸan bir sÃ¼recin varsayÄ±lan davranÄ±ÅŸÄ±nÄ± deÄŸiÅŸtirir; sÃ¼reÃ§ istisna almasÄ±na raÄŸmen koÅŸmaya devam edecektir. Bu uygulamanÄ±zÄ±n patlamasÄ±nÄ± Ã¶nlemek iÃ§in iyi bir yol gibi gÃ¶zÃ¼kebilir, ancak uygulamayÄ± yakalanmayan bir istisnadan sonra koÅŸturmaya devam ettirmek tehlikeli bir alÄ±ÅŸtÄ±rmadÄ±r ve tavsiye edilmez, Ã§Ã¼nkÃ¼ sÃ¼recin durumu (state) gÃ¼venilmez ve Ã¶ngÃ¶rÃ¼lemez hale gelir.</p>

<p>Ek olarak, <code>uncaughtException</code> kullanÄ±mÄ± resmen <a href="https://nodejs.org/api/process.html#process_event_uncaughtexception">ham</a> olarak tanÄ±nÄ±r. Yani <code>uncaughtException</code> olayÄ±nÄ± dinlemek gerÃ§ekten kÃ¶tÃ¼ bir fikirdir. Bu yÃ¼zden Ã§oklu sÃ¼reÃ§ler ve denetÃ§iler gibi ÅŸeyleri tavsiye ediyoruz: patladÄ±ktan sonra yeniden baÅŸlatma Ã§oÄŸu zaman bir hatayÄ± dÃ¼zeltmenin en gÃ¼venli yoludur.</p>

<p>AyrÄ±ca <a href="https://nodejs.org/api/domain.html">domains</a> kullanmanÄ±zÄ± tavsiye etmeyiz. Genellikle problemi Ã§Ã¶zmez ve de kullanÄ±mdan kaldÄ±rÄ±lmÄ±ÅŸ bir modÃ¼ldÃ¼r.</p>

<h4 id="try-catch-kullan">try-catch kullan</h4>

<p>Try-catch senkron kodda oluÅŸan istisnalarÄ± yakalamak iÃ§in kullanabileceÄŸiniz bir JavaScript dili yapÄ±sÄ±dÄ±r. Try-catch yapÄ±sÄ±nÄ±, Ã¶rneÄŸin, JSON ayrÄ±ÅŸtÄ±rma hatalarÄ±nÄ± aÅŸaÄŸÄ±da gÃ¶sterildiÄŸi gibi ele almak iÃ§in kullanÄ±n.</p>

<p><a href="http://www.jshint.com/docs/options/#undef">TanÄ±msÄ±z deÄŸiÅŸkenlerde referans hatalarÄ±</a> gibi kapalÄ± (implicit) istisnalarÄ± bulmak iÃ§in <a href="http://jshint.com/">JSHint</a> veya <a href="http://www.jslint.com/">JSLint</a> gibi araÃ§larÄ± kullanabilirsiniz.</p>

<p>Buradaki Ã¶rnek potansyel bir sÃ¼reÃ§-patlatÄ±cÄ± istisnayÄ± ele alman try-catch kullanÄ±mÄ±nÄ± gÃ¶sterir. Bu ara yazÄ±lÄ±m fonksiyonu JSON objesi olan â€œparamsâ€ adÄ±nda bir sorgu alanÄ± parametresi alÄ±yor.</p>

<pre><code class="language-js">app.get('/search', (req, res) =&gt; {
  // Simulating async operation
  setImmediate(() =&gt; {
    const jsonStr = req.query.params
    try {
      const jsonObj = JSON.parse(jsonStr)
      res.send('Success')
    } catch (e) {
      res.status(400).send('Invalid JSON string')
    }
  })
})
</code></pre>

<p>Ancak, try-catch sadece senkron kod iÃ§in Ã§alÄ±ÅŸÄ±r. Node platformu birincil olarak asenkron olduÄŸundan (Ã¶zellikle de bir Ã¼retim ortamÄ±nda), try-catch Ã§ok fazla istisna yakalamayacaktÄ±r.</p>

<h4 id="promise-kullan">Promise kullan</h4>

<p>Promiseâ€™lar <code>then()</code> kullanan asenkron kod bloklarÄ±nda herhangi bir istisnayÄ± (implicit / explicit) iÅŸleyebilir. Sadece <code>.catch(next)</code> ifadesini promise zincirlerinin sonuna ekleyin. Ã–rneÄŸin:</p>

<pre><code class="language-js">app.get('/', (req, res, next) =&gt; {
  // do some sync stuff
  queryDb()
    .then((data) =&gt; makeCsv(data)) // handle data
    .then((csv) =&gt; { /* handle csv */ })
    .catch(next)
})

app.use((err, req, res, next) =&gt; {
  // handle error
})
</code></pre>

<p>Åimdi bÃ¼tÃ¼n hatalar, asenkron ve senkron olmak Ã¼zere, hata iÅŸleyici ara yazÄ±lÄ±ma gider.</p>

<p>Ancak, iki uyarÄ± var:</p>

<ol>
  <li>BÃ¼tÃ¼n asenkron kodunuz promise dÃ¶ndÃ¼rmeli (yayÄ±cÄ±lar/emitter hariÃ§). EÄŸer belirli bir kÃ¼tÃ¼phane promise dÃ¶ndÃ¼rmÃ¼yorsa, <a href="http://bluebirdjs.com/docs/api/promise.promisifyall.html">Bluebird.promisifyAll()</a> gibi bir yardÄ±mcÄ± fonksiyon kullanarak temel objeyi dÃ¶nÃ¼ÅŸtÃ¼rÃ¼n.</li>
  <li>Olay yayÄ±cÄ±lar (akÄ±ÅŸlar gibi) yine de yakalanmayan istisnalara neden olabilir. O yÃ¼zden hata olayÄ±nÄ± dÃ¼zgÃ¼n bir ÅŸekilde ele aldÄ±ÄŸÄ±nÄ±zdan emin olur; Ã¶rneÄŸin:</li>
</ol>

<pre><code class="language-js">const wrap = fn =&gt; (...args) =&gt; fn(...args).catch(args[2])

app.get('/', wrap(async (req, res, next) =&gt; {
  const company = await getCompanyById(req.query.id)
  const stream = getLogoStreamById(company.id)
  stream.on('error', next).pipe(res)
}))
</code></pre>

<p><code>wrap()</code> fonksiyonu ret edilen promiseâ€™larÄ± yakalayÄ±p birinci argÃ¼manÄ± hata olarak <code>next()</code> fonkisyonunu Ã§aÄŸÄ±ran bir sarÄ±cÄ±dÄ±r (wrapper). Detaylar iÃ§in, bakÄ±nÄ±z <a href="https://strongloop.com/strongblog/async-error-handling-expressjs-es7-promises-generators/#cleaner-code-with-generators">Expressâ€™te Promise, Generator ve ES7 ile Asenkron Hata Ele Alma</a>.</p>

<p>Promiseâ€™lerle hata ele alma ile ilgili daha fazla bilgi iÃ§in bakÄ±nÄ±z <a href="https://strongloop.com/strongblog/promises-in-node-js-with-q-an-alternative-to-callbacks/">Node.jsâ€™te Q ile Promisâ€™ler â€“ Geri Ã§aÄŸrÄ±malara Bir Alternatif</a>.</p>

<h2 id="in-environment">OrtamÄ±nÄ±zda / kurulumunuzda yapÄ±lacak ÅŸeyler</h2>

<p>UygulamanÄ±zÄ±n performansÄ±nÄ± iyileÅŸtirmek iÃ§in sistem ortamÄ±nÄ±zda yapabileceÄŸiniz bazÄ± ÅŸeyler:</p>

<ul>
  <li><a href="#set-node_env-to-production">NODE_ENV deÄŸerini â€œproductionâ€ olarak ayarla</a></li>
  <li><a href="#ensure-your-app-automatically-restarts">UygulamanÄ±zÄ±n otomatik olarak yeniden baÅŸlatÄ±ldÄ±ÄŸÄ±ndan emin ol</a></li>
  <li><a href="#run-your-app-in-a-cluster">UygulamanÄ±zÄ± bir kÃ¼mede (cluster) koÅŸ</a></li>
  <li><a href="#cache-request-results">Ä°stek sonuÃ§larÄ±nÄ± Ã¶nbelleÄŸe al (cache)</a></li>
  <li><a href="#use-a-load-balancer">Bir yÃ¼k dengeleyicisi (load balancer) kullan</a></li>
  <li><a href="#use-a-reverse-proxy">Bir ters proxy kullan (reverse proxy)</a></li>
</ul>

<h3 id="nodeenv-deerini-production-olarak-ayarla">NODE_ENV deÄŸerini â€œproductionâ€ olarak ayarla</h3>

<p>NODE_ENV ortam deÄŸiÅŸkeni bir uygulamanÄ±n hangi ortamda koÅŸtuÄŸunu belirtir (genellikle development veya production olur). PerformansÄ± iyileÅŸtirmek iÃ§in yapabileceÄŸiniz en basit ÅŸeylerden biri NODE_ENV deÄŸerini â€œproductionâ€ olarak ayarlamaktÄ±r.</p>

<p>NODE_ENV â€œproductionâ€ olarak ayarlandÄ±ÄŸÄ±nda Express:</p>

<ul>
  <li>GÃ¶rÃ¼ntÃ¼ ÅŸablonlarÄ±nÄ± Ã¶nbelleÄŸe atar.</li>
  <li>CSS uzantÄ±larÄ±ndan oluÅŸturulan CSS dosyalarÄ±nÄ± Ã¶nbelleÄŸe atar.</li>
  <li>Daha az ayrÄ±ntÄ±lÄ± hata mesajlarÄ± Ã¼retir.</li>
</ul>

<p>YapÄ±lan <a href="http://apmblog.dynatrace.com/2015/07/22/the-drastic-effects-of-omitting-node_env-in-your-express-js-applications/">testler</a> sadece bunu yaparak uygulamanÄ±n performansÄ±nÄ±n Ã¼Ã§ kat arttÄ±ÄŸÄ±nÄ± gÃ¶steriyor!</p>

<p>EÄŸer Ã¶zellikle bir ortam iÃ§in kod yazmak istiyorsanÄ±z, NODE_ENV deÄŸiÅŸkeninin deÄŸerini <code>process.env.NODE_ENV</code> ile kontrol edebilirsiniz. Herhangi bir ortamÄ± deÄŸiÅŸkeninin deÄŸerini kontrol etmenin bir performans dÃ¼ÅŸÃ¼ÅŸÃ¼ meydana getirdiÄŸini unutmayÄ±n, ve bu yÃ¼zden bu iÅŸlem idareli yapÄ±lmalÄ±dÄ±r.</p>

<p>GeliÅŸtirme modunda, tipik olarak ortam deÄŸiÅŸkenlerini interaktif shellâ€™de <code>export</code> veya <code>.bash_profile</code> dosyasÄ±nÄ±zÄ± kullanarak ayarlayabilirsiniz. Ama genellikle Ã¼retim sunucusunda bunu yapmamalÄ±sÄ±nÄ±z; onun yerine, iÅŸletim sisteminizin init systemâ€™ini kullanabilirsiniz (systemd veya Upstart). Bir sonraki kÄ±sÄ±m genel init system kullanÄ±mÄ± hakkÄ±nda daha fazla detay veriyor, ama NODE_ENV deÄŸiÅŸkeninin ayarlanmasÄ± performans iÃ§in Ã§ok Ã¶nemli olduÄŸundan (ve yapmasÄ± da kolay olduÄŸundan) burada vurgulanmÄ±ÅŸtÄ±r.</p>

<p>Upstart ile, job dosyanÄ±zda <code>env</code> ifadesini kullanÄ±n. Ã–rnek olarak:</p>

<pre><code class="language-sh"># /etc/init/env.conf
 env NODE_ENV=production
</code></pre>

<p>Daha fazla bilgi iÃ§in bakÄ±nÄ±z <a href="http://upstart.ubuntu.com/cookbook/#environment-variables">Upstart Giril, Cookbook ve En Ä°yi Pratikler</a>.</p>

<p>Systemd ile, Ã¼nite dosyanÄ±zdaki <code>Environment</code> direktifini kullanÄ±n. Ã–rnek olarak:</p>

<pre><code class="language-sh"># /etc/systemd/system/myservice.service
Environment=NODE_ENV=production
</code></pre>

<p>Daha fazla bilgi iÃ§in bakÄ±nÄ±z <a href="https://coreos.com/os/docs/latest/using-environment-variables-in-systemd-units.html">Systemd Ãœnitelerindeki Ortam DeÄŸiÅŸkenlerini Kullanma</a>.</p>

<h3 id="uygulamanzn-otomatik-olarak-yeniden-balatldndan-emin-olun">UygulamanÄ±zÄ±n otomatik olarak yeniden baÅŸlatÄ±ldÄ±ÄŸÄ±ndan emin olun</h3>

<p>Ãœretim ortamÄ±nda hiÃ§bir zaman uygulamanÄ±zÄ±n Ã§evrimdÄ±ÅŸÄ± kalmasÄ±nÄ± istemezsiniz. Bu, uygulamanÄ±zÄ±n veya sunucunun kendisinin patlamasÄ± durumunda yeniden baÅŸlatÄ±ldÄ±ÄŸÄ±ndan emin olmanÄ±z gerektiÄŸi anlamÄ±na gelir. Bu olaylardan hiÃ§birinin olmamasÄ±nÄ± ummanÄ±za raÄŸmen, gerÃ§ekÃ§i olarak her iki olasÄ±lÄ±ÄŸÄ± da hesaba katarak:</p>

<ul>
  <li>PatladÄ±ÄŸÄ±nda uygulamayÄ± (ve Nodeâ€™u) yeniden baÅŸlatmak iÃ§in bir sÃ¼reÃ§ yÃ¶neticisi kullanmak.</li>
  <li>Ä°ÅŸletim sisteminiz tarafÄ±ndan saÄŸlanan init systemâ€™i kullanarak, iÅŸletim sistemi Ã§Ã¶ktÃ¼ÄŸÃ¼nde yeniden baÅŸlatmak. Init systemâ€™i bir sÃ¼reÃ§ yÃ¶neticisi olmadan da kullanabilirsiniz.</li>
</ul>

<p>Node uygulamalarÄ± yakalanmayan bir istisna ile karÅŸÄ±laÅŸtÄ±klarÄ±nda patlarlar. En baÅŸta yapmanÄ±z gereken ÅŸey uygulamanÄ±zÄ±n iyi test edilmiÅŸ olmasÄ±nÄ± ve bÃ¼tÃ¼n istisnalarÄ± (detaylar iÃ§in bakÄ±nÄ±z <a href="#handle-exceptions-properly">istisnalarÄ± dÃ¼zgÃ¼n bir ÅŸekilde ele almak</a>) ele aldÄ±ÄŸÄ±nÄ± saÄŸlamaktÄ±r. Ancak yine de tedbir olarak, uygulamanÄ±z patlarsa ve patladÄ±ÄŸÄ±nda, yeniden baÅŸlatÄ±lacaÄŸÄ±nÄ± saÄŸlayan bir mekanizmayÄ± yapmak.</p>

<h4 id="sre-yneticisi-kullan">SÃ¼reÃ§ yÃ¶neticisi kullan</h4>

<p>GeliÅŸtirme ortamÄ±nda, uygulamanÄ±zÄ± basitÃ§e komut satÄ±rÄ±ndan <code>node server.js</code> veya benzeri bir ÅŸeyle baÅŸlatÄ±rsÄ±nÄ±z. Ama bunu Ã¼retim ortamÄ±nda yapmak, felakete davetiye Ã§Ä±karmaktÄ±r. Uygulama patladÄ±ÄŸÄ±nda, siz tekrar baÅŸlatana kadar Ã§evrimdÄ±ÅŸÄ± kalacaktÄ±r. PatladÄ±ÄŸÄ±nda uygulamanÄ±zÄ±n yeniden baÅŸlatÄ±lmasÄ±nÄ± saÄŸlamak iÃ§in bir sÃ¼reÃ§ yÃ¶neticisi kullanÄ±n. SÃ¼reÃ§ yÃ¶neticisi, uygulamalarÄ±n daÄŸÄ±tÄ±mÄ±nÄ± (deployment) kolaylaÅŸtÄ±rÄ±an, yÃ¼ksek kullanÄ±labilirlik saÄŸlayan ve uygulamayÄ± Ã§alÄ±ÅŸma zamanÄ±nda yÃ¶netmeye imkan saÄŸlayan konteynerlardÄ±r.</p>

<p>UygulamanÄ±zÄ±n patladÄ±ÄŸÄ±nda tekrar baÅŸlatÄ±lmasÄ±na ek olarak, bir sÃ¼reÃ§ yÃ¶neticisi aÅŸaÄŸÄ±dakileri yapabilmenizi saÄŸlar:</p>

<ul>
  <li>Ã‡alÄ±ÅŸma zamanÄ± performansÄ± ve kaynak tÃ¼ketimi hakkÄ±nda iÃ§gÃ¶rÃ¼ler elde edebilme.</li>
  <li>PerformansÄ± iyileÅŸtirmek iÃ§in ayarlarÄ± dinamik olarak deÄŸiÅŸtirme.</li>
  <li>Cluster kontrolÃ¼ (StrongLoop PM ve pm2).</li>
</ul>

<p>Node iÃ§in en popÃ¼ler sÃ¼reÃ§ yÃ¶neticileri aÅŸaÄŸÄ±dakilerdir:</p>

<ul>
  <li><a href="http://strong-pm.io/">StrongLoop SÃ¼reÃ§ YÃ¶neticisi</a></li>
  <li><a href="https://github.com/Unitech/pm2">PM2</a></li>
  <li><a href="https://www.npmjs.com/package/forever">Forever</a></li>
</ul>

<p>Bu Ã¼Ã§ sÃ¼reÃ§ yÃ¶neticisinin Ã¶zellik bazÄ±nda bir karÅŸÄ±laÅŸtÄ±rmasÄ± iÃ§in bakÄ±nÄ±z <a href="http://strong-pm.io/compare/">http://strong-pm.io/compare/</a>. Her Ã¼Ã§Ã¼ ile ilgili daha detaylÄ± bir giriÅŸ iÃ§in bakÄ±nÄ±z <a href="/tr/advanced/pm.html">Express uygulamalarÄ± iÃ§in sÃ¼reÃ§ yÃ¶neticileri</a>.</p>

<p>UygulamanÄ±z zaman zaman patlasa bile, bu sÃ¼reÃ§ yÃ¶neticilerinden birini kullanmanÄ±z uygulamanÄ±zÄ± ayakta tutmak iÃ§in yeterli olacaktÄ±r.</p>

<p>Ancak, StrongLoop sÃ¼reÃ§ yÃ¶neticisi Ã¶zellikle Ã¼retim daÄŸÄ±tÄ±mÄ±nÄ± hedefleyen birÃ§ok Ã¶zelliÄŸe sahiptir. BunlarÄ± ve ilgili StrongLoop araÃ§larÄ±nÄ± aÅŸaÄŸÄ±dakileri yapmak iÃ§in kullanabilirsiniz:</p>

<ul>
  <li>UygulamanÄ±zÄ± lokal olarak derleyip paketlemek, ve daha sonra gÃ¼venli bir ÅŸekilde Ã¼retim sisteminize daÄŸÄ±tmak.</li>
  <li>Herhangi bir nedenden dolayÄ± uygulamanÄ±z patladÄ±ÄŸÄ±nda otomatik olarak yeniden baÅŸlatmak.</li>
  <li>KÃ¼melerinizi (cluster) uzaktan yÃ¶netmek.</li>
  <li>PerformansÄ± iyileÅŸtirmek ve bellek sÄ±zÄ±ntÄ±larÄ±nÄ± teÅŸhis etmek iÃ§in CPU profillerini ve heap anlÄ±k gÃ¶rÃ¼ntÃ¼lerini gÃ¶rÃ¼ntÃ¼lemek.</li>
  <li>UygulamanÄ±z iÃ§in performans Ã¶lÃ§Ã¼lerini gÃ¶rÃ¼ntÃ¼lemek.</li>
  <li>Nginx yÃ¼k dengeleyici iÃ§in entegre kontrol ile birden Ã§ok ana bilgisayara kolayca Ã¶lÃ§eklendirmek.</li>
</ul>

<p>AÅŸaÄŸÄ±da anlatÄ±ldÄ±ÄŸÄ± gibi, init systeminizi kullanarak StronLoop sÃ¼reÃ§ yÃ¶neticisini iÅŸletim sistemi servisi olarak yÃ¼klediÄŸinizde, sistem tekrar baÅŸlatÄ±ldÄ±ÄŸÄ±nda bu da tekrar baÅŸlatÄ±lacaktÄ±r. DolayÄ±sÄ±yla, uygulamanÄ±zÄ±n sÃ¼reÃ§lerini ve kÃ¼melerini sonsuza dek beraber ayakta tutacaktÄ±r.</p>

<h4 id="init-system-kullan">Init system kullan</h4>

<p>GÃ¼venilirliÄŸin bir sonraki katmanÄ±, sunucu yeniden baÅŸladÄ±ÄŸÄ±nda uygulamanÄ±zÄ±n da yeniden baÅŸlatÄ±lmasÄ±nÄ± saÄŸlamaktÄ±r. Sistemler Ã§eÅŸitli nedenlerle yine de Ã§Ã¶kebilir. Sunucu patladÄ±ÄŸÄ±nda uygulamanÄ±zÄ±nda yeniden baÅŸlatÄ±ldÄ±ÄŸÄ±ndan emin olmak iÃ§in, iÅŸletim sisteminizdeki gÃ¶mÃ¼lÃ¼ init systemâ€™i kullanÄ±n. BugÃ¼n kullanÄ±mda olan iki ana init system ÅŸunlardÄ±r: <a href="https://wiki.debian.org/systemd">systemd</a> ve <a href="http://upstart.ubuntu.com/">Upstart</a>.</p>

<p>Express uygulamanÄ±zda init systemâ€™i kullanmanÄ±n iki yolu var:</p>

<ul>
  <li>UygulamanÄ±zÄ± bir sÃ¼reÃ§ yÃ¶neticisinde koÅŸun, ve sÃ¼reÃ§ yÃ¶neticisini bir servis olarak init systemâ€™le yÃ¼kleyin. SÃ¼reÃ§ yÃ¶neticisi, uygulamanÄ±z patladÄ±ÄŸÄ±nda yeniden baÅŸlatacaktÄ±r, ve iÅŸletim sistemi de yeniden baÅŸlatÄ±ldÄ±ÄŸÄ±nda, init system sÃ¼reÃ§ yÃ¶neticisini baÅŸlatacaktÄ±r. Tavsiye edilen yaklaÅŸÄ±m budur.</li>
  <li>UygulamanÄ±zÄ± (ve Nodeâ€™u) direkt olarak init system ile koÅŸun. Bu biraz daha basittir, ama sÃ¼reÃ§ yÃ¶neticisini kullanmanÄ±n verdiÄŸi ek avantajlarÄ± elde etmiyorsunuz.</li>
</ul>

<h5 id="systemd">Systemd</h5>

<p>Systemd, bir Linux sistemi ve servis yÃ¶neticisidir. Ã‡oÄŸu bÃ¼yÃ¼k Linux daÄŸÄ±tÄ±mlarÄ± varsayÄ±lan init system olarak systemdâ€™yi benimsemiÅŸtir.</p>

<p>Bir systemd servis konfigÃ¼rasyon dosyasÄ±na <em>unit file</em> denir ve <code>.service</code> dosya ismiyle biter. AÅŸaÄŸÄ±daki Ã¶rnek bir Node uygulamasÄ±nÄ± direkt olarak yÃ¶neten bir unit dosyasÄ±nÄ± gÃ¶sterir. <code>&lt;angle brackets&gt;</code> ile kapanmÄ±ÅŸ deÄŸerleri uygulamanÄ±z ve sisteminiz ile deÄŸiÅŸtirin:</p>

<pre><code class="language-sh">[Unit]
Description=&lt;Awesome Express App&gt;

[Service]
Type=simple
ExecStart=/usr/local/bin/node &lt;/projects/myapp/index.js&gt;
WorkingDirectory=&lt;/projects/myapp&gt;

User=nobody
Group=nogroup

# Ortam deÄŸiÅŸkenleri:
Environment=NODE_ENV=production

# Birden fazla gelen baÄŸlantÄ±ya izin ver
LimitNOFILE=infinity

# Hata ayÄ±klama iÃ§in temel dÃ¶kÃ¼mlere (core dump) izin ver
LimitCORE=infinity

StandardInput=null
StandardOutput=syslog
StandardError=syslog
Restart=always

[Install]
WantedBy=multi-user.target
</code></pre>
<p>Systemd ile ilgili daha fazla bilgi iÃ§in bakÄ±nÄ±z <a href="http://www.freedesktop.org/software/systemd/man/systemd.unit.html">systemd referansÄ± (kÄ±lavuz)</a>.</p>

<h5 id="systemd-servisi-olarak-strongloop-pm-sre-yneticisi">systemd servisi olarak StrongLoop PM (sÃ¼reÃ§ yÃ¶neticisi)</h5>

<p>StrongLoop sÃ¼reÃ§ yÃ¶neticisini systemd servisi olarak kolaylÄ±kla yÃ¼kleyebilirsiniz. Bunu yaptÄ±ktan sonra, sunucu yeniden baÅŸlatÄ±ldÄ±ÄŸÄ±nda, StrongLoop sÃ¼reÃ§ yÃ¶neticisini de otomatik olarak baÅŸlatÄ±lacak, ve bu da StrongLoop tarafÄ±ndan yÃ¶netilen bÃ¼tÃ¼n uygulamalarÄ±n yeniden baÅŸlatÄ±lmasÄ±nÄ± saÄŸlayacak.</p>

<p>StrongLoop sÃ¼reÃ§ yÃ¶neticisini bir systemd servisi olarak yÃ¼klemek iÃ§in:</p>

<pre><code class="language-console">$ sudo sl-pm-install --systemd
</code></pre>

<p>Daha sonra, servisi baÅŸlatmak iÃ§in:</p>

<pre><code class="language-console">$ sudo /usr/bin/systemctl start strong-pm
</code></pre>

<p>Daha fazla bilgi iÃ§in bakÄ±nÄ±z <a href="https://docs.strongloop.com/display/SLC/Setting+up+a+production+host#Settingupaproductionhost-RHEL7+,Ubuntu15.04or15.10">Ãœretim hostu kurmak (StrongLoop dÃ¶kÃ¼mantasyonu)</a>.</p>

<h5 id="upstart">Upstart</h5>

<p>Upstart, birÃ§ok Linux daÄŸÄ±tÄ±mÄ±nda bulunan sistem baÅŸlangÄ±cÄ±nda gÃ¶revleri ve servisleri baÅŸlatan, kapanma sÄ±rasÄ±nda kapatan ve denetleyen bir sistem aracÄ±dÄ±r. Express uygulamanÄ±zÄ± veya sÃ¼reÃ§ yÃ¶neticinizi bir servis olarak yapÄ±landÄ±rabilirsiniz ve bunlar patladÄ±ÄŸÄ±nda, Upstart otomatik olarak yeniden baÅŸlatacaktÄ±r.</p>

<p>Bir Upstart servisi, <code>.conf</code> uzantÄ±lÄ± bir job konfigÃ¼rasyon dosyasÄ±nda (â€œjobâ€ olarak adlandÄ±rÄ±lÄ±r) tanÄ±mlanÄ±r. AÅŸaÄŸÄ±daki Ã¶rnek, ana dosyasÄ± <code>/projects/myapp/index.js</code> konumunda bulunan â€œmyappâ€ adÄ±nda bir uygulama iÃ§in â€œmyappâ€ adÄ±nda bir job yaratmayÄ± gÃ¶sterir.</p>

<p>AÅŸaÄŸÄ±dakileri iÃ§ererek <code>/etc/init/</code> konumunda <code>myapp.conf</code> adÄ±nda bir dosya yaratÄ±n (kalÄ±n yazÄ±larÄ± sisteminizin ve uygulamanÄ±zÄ±n deÄŸerleriyle deÄŸiÅŸtirin):</p>

<pre><code class="language-sh"># SÃ¼recin ne zaman baÅŸlayacaÄŸÄ±
start on runlevel [2345]

# SÃ¼recin ne zaman duracaÄŸÄ±
stop on runlevel [016]

# Daha fazla isteÄŸi iÅŸleyebilmek iÃ§in dosya tanÄ±mlayÄ±cÄ± sÄ±nÄ±rÄ±nÄ± artÄ±r
limit nofile 50000 50000

# production modunu kullan
env NODE_ENV=production

# www-data olarak koÅŸ
setuid www-data
setgid www-data

# UygulamanÄ±n dizininden koÅŸ
chdir /projects/myapp

# BaÅŸlatÄ±lacak sÃ¼reÃ§
exec /usr/local/bin/node /projects/myapp/index.js

# SÃ¼reÃ§ Ã§Ã¶ktÃ¼ÄŸÃ¼nde yeninden baÅŸlat
respawn

# Yeniden baÅŸlatma giriÅŸimini 10 saniye iÃ§inde 10 kez ile sÄ±nÄ±rla
respawn limit 10 10
</code></pre>

<p>NOT: Bu kod Ubuntu 12.04-14.10â€™da desteklenen Upstart 1.4 ve Ã¼stÃ¼ne ihtiyaÃ§ duyar.</p>

<p>Job, sistem baÅŸladÄ±ÄŸÄ±nda koÅŸmasÄ± iÃ§in yapÄ±landÄ±rÄ±ldÄ±ÄŸÄ±ndan uygulamanÄ±z da iÅŸletim sistemiyle beraber baÅŸlayacak, ve sistem Ã§Ã¶ktÃ¼ÄŸÃ¼nde veya uygulama patladÄ±ÄŸÄ±nda otomatik olarak yeniden baÅŸlatÄ±lacaktÄ±r.</p>

<p>UygulamanÄ±n otomatik olarak yeniden baÅŸlatÄ±lmasÄ±nÄ±n yanÄ±ndan, Upstart aÅŸaÄŸÄ±daki komutlarÄ± da kullanmanÄ±zÄ± saÄŸlar:</p>

<ul>
  <li><code>start myapp</code> â€“ UygulamayÄ± baÅŸlat</li>
  <li><code>restart myapp</code> â€“ UygulamayÄ± yeniden baÅŸlat</li>
  <li><code>stop myapp</code> â€“ UygulamayÄ± durdur</li>
</ul>

<p>Upstart ile ilgili daha fazla bilgi iÃ§in bakÄ±nÄ±z <a href="http://upstart.ubuntu.com/cookbook">Upstart GiriÅŸ, KÄ±lavuz and En Ä°yi Pratikler</a>.</p>

<h5 id="upstart-servisi-olarak-strongloop-sre-yneticisi">Upstart servisi olarak StrongLoop sÃ¼reÃ§ yÃ¶neticisi</h5>

<p>StrongLoop sÃ¼reÃ§ yÃ¶neticisini bir Upstart servisi olarak kolaylÄ±kla yÃ¼kleyebilirsiniz. Bunu yaptÄ±ktan sonra, sunucu yeninden baÅŸladÄ±ÄŸÄ±nda StrongLoop sÃ¼reÃ§ yÃ¶neticisini otomatik olarak yeniden baÅŸlatÄ±r, ve sÃ¼reÃ§ yÃ¶neticisinin yÃ¶nettiÄŸi bÃ¼tÃ¼n uygulamalarÄ± da yeniden baÅŸlatÄ±r.</p>

<p>Strong Loop sÃ¼reÃ§ yÃ¶neticisini bir Upstart 1.4 servisi olarak yÃ¼klemek iÃ§in:</p>

<pre><code class="language-console">$ sudo sl-pm-install
</code></pre>

<p>Daha sonra servisi koÅŸmak iÃ§in:</p>

<pre><code class="language-console">$ sudo /sbin/initctl start strong-pm
</code></pre>

<p>NOT: Upstart 1.4â€™Ã¼ desteklemeyen sistemlerde bu komutlar biraz farklÄ±dÄ±r. Daha fazla bilgi iÃ§in bakÄ±nÄ±z <a href="https://docs.strongloop.com/display/SLC/Setting+up+a+production+host#Settingupaproductionhost-RHELLinux5and6,Ubuntu10.04-.10,11.04-.10">Production hostu kurmak (StrongLoop dÃ¶kÃ¼mantasyonu)</a>.</p>

<h3 id="uygulamanz-bir-kmede-cluster-ko">UygulamanÄ±zÄ± bir kÃ¼mede (cluster) koÅŸ</h3>

<p>Ã‡ok Ã§ekirdekli bir sistemde, bir iÅŸlemler kÃ¼mesi baÅŸlatarak bir Node uygulamasÄ±nÄ±n performansÄ±nÄ± birÃ§ok kez artÄ±rabilirsiniz. Bir kÃ¼me, uygulamanÄ±n birden fazla Ã¶rneÄŸini koÅŸar, ideal olarak her bir CPU Ã§ekirdeÄŸinde bir Ã¶rnek olacak ÅŸekilde, dolayÄ±sÄ±yla da yÃ¼k ve gÃ¶revleri Ã¶rneklerin arasÄ±nda daÄŸÄ±tÄ±r.</p>

<p><img src="/images/clustering.png" alt="cluster API kullanarak uygulama Ã¶rnekleri arasÄ±nda dengeleme" /></p>

<p>Ã–NEMLÄ°: Uygulama Ã¶rnekleri ayrÄ± sÃ¼reÃ§ler olarak koÅŸtuklarÄ±ndan, aynÄ± hafÄ±za alanÄ±nÄ± paylaÅŸmÄ±yorlar. Yani, objeler her uygulama Ã¶rneÄŸi iÃ§in lokaldir. Bu nedenle, uygulama kodunda durumu (state) koruyamazsÄ±nÄ±z. Ancak, durum ve oturum ile ilgili veriyi depolamak iÃ§in <a href="http://redis.io/">Redis</a> gibi bir in-memory veri deposu kullanabilirsiniz. Bu uyarÄ± esases, kÃ¼meleme birden fazla sÃ¼reÃ§ ya da birden fazla fiziksel sunucularla olsun, tÃ¼m yatay Ã¶lÃ§ekleme biÃ§imleri iÃ§in geÃ§erlidir.</p>

<p>KÃ¼melenmiÅŸ uygulamalarda, Ã§alÄ±ÅŸan sÃ¼reÃ§leri (worker process) bireysel olarak geri kalan sÃ¼reÃ§leri etkilemeden Ã§Ã¶kebilirler. Performans avantajlarÄ±ndan ayrÄ± olarak, arÄ±za izolasyonu, bir uygulama sÃ¼reÃ§leri kÃ¼mesini Ã§alÄ±ÅŸtÄ±rmanÄ±n baÅŸka bir nedenidir. Ne zaman bir Ã§alÄ±ÅŸan sÃ¼reci Ã§Ã¶kerse, olayÄ± loglayÄ±p ve <code>cluster.fork()</code> kullanarak yeni bir sÃ¼reÃ§ yaratmayÄ± unutmayÄ±n.</p>

<h4 id="nodeun-cluster-modln-kullan">Nodeâ€™un cluster modÃ¼lÃ¼nÃ¼ kullan</h4>

<p>KÃ¼meleme, Nodeâ€™un <a href="https://nodejs.org/dist/latest-v4.x/docs/api/cluster.html">cluster modÃ¼lÃ¼</a> sayesinde mÃ¼mkÃ¼n hale gelmiÅŸtir. Bu, bir ana sÃ¼recin Ã§alÄ±ÅŸan sÃ¼reÃ§leri Ã¼retmesini ve gelen baÄŸlantÄ±larÄ± Ã§alÄ±ÅŸanlar arasÄ±nda daÄŸÄ±tmasÄ±nÄ± saÄŸlar. Ancak, direkt olarak bu modÃ¼lÃ¼ kullanmak yerine, bu iÅŸi otomatik olarak yapan birÃ§ok araÃ§tan birini kullanmak Ã§ok daha iyi; Ã¶rneÄŸin <a href="https://www.npmjs.com/package/node-pm">node-pm</a> ya da <a href="https://www.npmjs.com/package/cluster-service">cluster-service</a>.</p>

<h4 id="strongloop-sre-yneticisi-kullan">StrongLoop sÃ¼reÃ§ yÃ¶neticisi kullan</h4>

<p>UygulamanÄ±zÄ± StrongLoop sÃ¼reÃ§ yÃ¶neticisine daÄŸÄ±tÄ±rsanÄ±z, uygulamanÄ±zÄ±n kodunu <em>deÄŸiÅŸtirmeden</em> kÃ¼melemenin avantajÄ±ndan yararlanabilirsiniz.</p>

<p>StrongLoop sÃ¼reÃ§ yÃ¶neticisi bir uygulamayÄ± koÅŸtuÄŸunda, sistemdeki CPU Ã§ekirdeÄŸi sayÄ±sÄ±na eÅŸit sayÄ±da Ã§alÄ±ÅŸanÄ± olan bir kÃ¼mede otomatik olarak Ã§alÄ±ÅŸtÄ±rÄ±r. UygulamayÄ± durdurmadan slc komut satÄ±rÄ± aracÄ±nÄ± kullanarak kÃ¼medeki Ã§alÄ±ÅŸan sÃ¼reÃ§lerin sayÄ±sÄ±nÄ± manuel olarak deÄŸiÅŸtirebilirsiniz.</p>

<p>Ã–rnek olarak, uygulamanÄ±zÄ± prod.foo.comâ€™a daÄŸÄ±ttÄ±ÄŸÄ±nÄ±zÄ± ve StrongLoop sÃ¼reÃ§ yÃ¶neticisinin de port 8701â€™de (varsayÄ±lan) dinlediÄŸini varsayarsak, slc kullanarak kÃ¼menin bÃ¼yÃ¼klÃ¼ÄŸÃ¼nÃ¼ sekize ayarlamak iÃ§in:</p>

<pre><code class="language-console">$ slc ctl -C http://prod.foo.com:8701 set-size my-app 8
</code></pre>

<p>StrongLoop ile kÃ¼meleme hakkÄ±nda daha fazla bilgi iÃ§in, StrongLoop dÃ¶kÃ¼mantasyonuna bakÄ±nÄ±z: <a href="https://docs.strongloop.com/display/SLC/Clustering">KÃ¼meleme</a></p>

<h4 id="pm2-kullan">PM2 kullan</h4>

<p>UygulamanÄ±zÄ± PM2 ile daÄŸÄ±tÄ±rsanÄ±z, uygulamanÄ±zÄ±n kodunu <em>deÄŸiÅŸtirmeden</em> kÃ¼melemenin avantajÄ±ndan yararlanabilirsiniz. Ä°lk Ã¶nce <a href="http://pm2.keymetrics.io/docs/usage/specifics/#stateless-apps">uygulamanÄ±zÄ±n durumsuz (stateless)</a> olmasÄ±nÄ± saÄŸlamalÄ±sÄ±nÄ±z, yani sÃ¼reÃ§te herhangi bir lokal veri saklanmamalÄ±dÄ±r (oturum, websocket vb. baÄŸlantÄ±lar).</p>

<p>PM2 ile bir uygulama koÅŸulduÄŸunda, seÃ§tiÄŸiniz Ã¶rnek sayÄ±sÄ±yla beraber bir kÃ¼mede Ã§alÄ±ÅŸtÄ±rmak iÃ§in <strong>kÃ¼me modu</strong>nu etkinleÅŸtirebilirsiniz, makinedeki mevcut CPU sayÄ±sÄ±yla eÅŸleÅŸtirilmesi gibi. UygulamayÄ± durdurmadan <code>pm2</code> komut satÄ±rÄ± aracÄ±nÄ± kullanarak kÃ¼medeki sÃ¼reÃ§ sayÄ±sÄ±nÄ± elle deÄŸiÅŸtirebilirsiniz.</p>

<p>KÃ¼me modunu etkinleÅŸtirmek iÃ§in, uygulamanÄ±zÄ± bu ÅŸekilde baÅŸlatÄ±n:</p>

<pre><code class="language-console"># 4 Ã§alÄ±ÅŸan sÃ¼reÃ§ baÅŸlat
$ pm2 start app.js -i 4
# Mevcut CPU sayÄ±sÄ±nÄ± otomatik olarak tespit et ve o sayÄ± kadar Ã§alÄ±ÅŸan sÃ¼reÃ§ baÅŸlat
$ pm2 start app.js -i max
</code></pre>

<p>Bu aynÄ± zamanda <code>exec_mode</code> deÄŸerini <code>cluster</code> ve <code>instances</code> deÄŸerini de baÅŸlangÄ±Ã§ Ã§alÄ±ÅŸan sayÄ±sÄ± olarak ayarlayarak bir PM2 sÃ¼reÃ§ dosyasÄ± (<code>ecosystem.config.js</code> ya da benzeri) iÃ§inde de yapÄ±landÄ±rÄ±labilir</p>

<p>KoÅŸmaya baÅŸladÄ±ktan sonra, <code>app</code> isminde belirli bir uygulama aÅŸaÄŸÄ±daki gibi Ã¶lÃ§eklenebilir:</p>

<pre><code class="language-console"># 3 tane daha Ã§alÄ±ÅŸan ekle
$ pm2 scale app +3
# Belirli bir Ã§alÄ±ÅŸan sayÄ±nÄ±a Ã¶lÃ§eklendir
$ pm2 scale app 2
</code></pre>

<p>PM2 ile kÃ¼meleme hakkÄ±nda daha fazla bilgi iÃ§in PM3 dÃ¶kÃ¼mantasyonuna bakÄ±nÄ±z: <a href="https://pm2.keymetrics.io/docs/usage/cluster-mode/">Cluster Mode</a></p>

<h3 id="stek-sonularn-nbellee-al">Ä°stek sonuÃ§larÄ±nÄ± Ã¶nbelleÄŸe al</h3>

<p>Ãœretim ortamÄ±nda performansÄ± artÄ±rmak iÃ§in bir baÅŸka strateji, isteklerin sonucunu Ã¶nbelleÄŸe almaktÄ±r, bÃ¶ylece uygulamanÄ±z aynÄ± isteÄŸi tekrar tekrar sunmak iÃ§in iÅŸlemi tekrarlamaz.</p>

<p>UygulamanÄ±zÄ±n hÄ±zÄ±nÄ± ve performansÄ±nÄ± bÃ¼yÃ¼k Ã¶lÃ§Ã¼de iyileÅŸtirmek iÃ§in <a href="https://www.varnish-cache.org/">Varnish</a> veya <a href="https://www.nginx.com/resources/wiki/start/topics/examples/reverseproxycachingexample/">Nginx</a> (ayrÄ±ca bakÄ±nÄ±z <a href="https://serversforhackers.com/nginx-caching/">Nginx Caching</a>) gibi bir Ã¶nbelleÄŸe alma sunucusu kullanÄ±n.</p>

<h3 id="bir-yk-dengeleyicisi-kullan">Bir yÃ¼k dengeleyicisi kullan</h3>

<p>Bir uygulama ne kadar optimize edilmiÅŸ olursa olsun, tek bir Ã¶rnek yalnÄ±zca sÄ±nÄ±rlÄ± miktarda yÃ¼k ve trafiÄŸi kaldÄ±rabilir. Bir uygulamayÄ± Ã¶lÃ§eklendirmenin bir yolu, birden Ã§ok Ã¶rneÄŸini Ã§alÄ±ÅŸtÄ±rmak ve trafiÄŸi bir yÃ¼k dengeleyici aracÄ±lÄ±ÄŸÄ±yla daÄŸÄ±tmaktÄ±r. Bir yÃ¼k dengeleyici kurmak, uygulamanÄ±zÄ±n performansÄ±nÄ± ve hÄ±zÄ±nÄ± artÄ±rabilir ve tek bir Ã¶rnekle mÃ¼mkÃ¼n olandan daha fazla Ã¶lÃ§eklenmesini saÄŸlayabilir.</p>

<p>YÃ¼k dengeleyici, genellikle birden Ã§ok uygulama Ã¶rneÄŸi ve sunucusuna gelen ve giden trafiÄŸi dÃ¼zenleyen bir ters proxyâ€™dir. <a href="http://nginx.org/en/docs/http/load_balancing.html">Nginx</a> veya <a href="https://www.digitalocean.com/community/tutorials/an-introduction-to-haproxy-and-load-balancing-concepts">HAProxy</a> kullanarak uygulamanÄ±z iÃ§in bir yÃ¼k dengeleyiciyi kolayca kurabilirsiniz.</p>

<p>YÃ¼k dengeleyici kullanÄ±rken, belirli bir oturum kimliÄŸiyle iliÅŸkili isteklerin, onlarÄ± oluÅŸturan sÃ¼rece baÄŸlanmasÄ±nÄ± saÄŸlamanÄ±z gerekebilir. Bu, <em>oturum yakÄ±nlÄ±ÄŸÄ± (session affinity)</em>, veya <em>yapÄ±ÅŸkan oturumlar (sticky sessions)</em> olarak bilinir, ve oturum verileri iÃ§in Redis gibi bir veri deposunun kullanÄ±lmasÄ± iÃ§in yukarÄ±daki Ã¶neri ile ele alÄ±nabilir (uygulamanÄ±za baÄŸlÄ± olarak). TartÄ±ÅŸma iÃ§in bakÄ±nÄ±z <a href="http://socket.io/docs/using-multiple-nodes/">Birden Ã§ok node kullanmak</a>.</p>

<h3 id="ters-proxy-kullan">Ters proxy kullan</h3>

<p>Bir ters proxy, bir web uygulamasÄ±nÄ±n Ã¶nÃ¼nde oturur ve istekleri uygulamaya yeniden yÃ¶nlendirmenin yanÄ± sÄ±ra istekler Ã¼zerinde destekleyici iÅŸlemler gerÃ§ekleÅŸtirir. DiÄŸer ÅŸeylerin yanÄ± sÄ±ra hata sayfalarÄ±nÄ±, sÄ±kÄ±ÅŸtÄ±rmayÄ±, Ã¶nbelleÄŸe almayÄ±, dosyalarÄ± sunmayÄ± ve yÃ¼k dengelemeyi de iÅŸleyebilir.</p>

<p>Handing over tasks that do not require knowledge of application state to a reverse proxy frees up Express to perform specialized application tasks. For this reason, it is recommended to run Express behind a reverse proxy like <a href="https://www.nginx.com/">Nginx</a> or <a href="http://www.haproxy.org/">HAProxy</a> in production.</p>

<p>Uygulama durumu (state) bilgisi gerektirmeyen gÃ¶revleri bir ters proxyâ€™ye devretmek, Ã¶zel uygulama gÃ¶revlerini gerÃ§ekleÅŸtirmek iÃ§in Expressâ€™i serbest bÄ±rakÄ±r. Bu nedenle, Ã¼retim ortamÄ±nda Expressâ€™i <a href="https://www.nginx.com/">Nginx</a> veya <a href="http://www.haproxy.org/">HAProxy</a> gibi bir ters proxyâ€™nin arkasÄ±nda koÅŸmak tavsiye edilir.</p>

      </div>
    </section>

    <a id="top" href="#"><img src="/images/arrow.png"></a>

<footer>
  <section id="doc-langs">
   <a href="http://strongloop.com">StrongLoop/IBM</a> tarafÄ±ndan saÄŸlanan belge Ã§evirileri:
  <a href="/fr/">FransÄ±zca</a>, <a href="/de/">Almanca</a>, <a href="/es/">Ä°spanyolca</a>, <a href="/it/">Ä°talyanca</a>, <a href="/ja/">Japonca</a>, <a href="/ru/">RusÃ§a</a>, <a href="/zh-cn/">Ã‡ince</a>, <a href="/zh-tw/">Klasik Ã‡ince</a>, <a href="/ko/">Korece</a>, <a href="/pt-br/">Portekizce</a>.
  <br>
  Topluluk Ã§evirisi iÃ§in: <a href="/sk/">SlovakÃ§a</a>, <a href="/uk/">Ukraynaca</a> and <a href="/uz/">Ã–zbekÃ§e</a>.
  </section>
  <div id="footer-content">
      <div id="github">
        <a class="github-button" href="https://github.com/expressjs/expressjs.com" data-icon="octicon-star" aria-label="Star expressjs/expressjs.com on GitHub">Star</a>
      </div>
      <div id="sponsor"><a href="https://expressjs.com">Express</a> bir <a href="https://openjsf.org">OpenJS VakfÄ±</a> projesidir.</div>
      <div id="fork"><a href="https://github.com/expressjs/expressjs.com">Github'da Forkla</a>.</div>
      <div>Telif HakkÄ± &copy; 2017 StrongLoop, IBM, ve diÄŸer expressjs.com katkÄ±da bulunanlar.</div>
  </div>
  <div id="license">
      <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/us/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/3.0/us/80x15.png" /></a> Bu iÅŸ<a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/us/">Creative Commons Attribution-ShareAlike 3.0 United States License</a> lisansÄ± altÄ±ndadÄ±r.
  </div>
</footer>

<script async defer src="https://buttons.github.io/buttons.js"></script>

<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js" onload="docsearch({
  apiKey: '7164e33055faa6ecddefd9e08fc59f5d',
  indexName: 'expressjs',
  inputSelector: '#q',
  algoliaOptions: { 'facetFilters': ['lang:tr'] }
})" async></script>



  </body>

</html>

